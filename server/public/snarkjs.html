<!doctype html>
<html>
<head>
  <title>Snarkjs client example</title>
</head>
<body>

  <h1>Snarkjs client example</h1>
  <button id="bGenProof"> Create proof </button>

  <!-- JS-generated output will be added here. -->
  <pre class="proof"> Proof: <code id="proof"></code></pre>

  <pre class="proof"> Result: <code id="result"></code></pre>


  <script src="https://cdn.jsdelivr.net/npm/snarkjs@0.6.11/build/snarkjs.min.js"></script>


  <pre class="proof"> publicSignals: <code id="publicSignals"></code></pre>
  <pre class="proof"> proofList: <code id="proofList"></code></pre>


  <!-- This is the bundle generated by rollup.js -->
  <script>

const proofComponent = document.getElementById('proof');
const resultComponent = document.getElementById('result');
const bGenProof = document.getElementById("bGenProof");

const publicSignals = document.getElementById('publicSignals');
const proofList = document.getElementById('proofList');

bGenProof.addEventListener("click", calculateProof);

async function calculateProof() {

    const { proof, publicSignals } =
      await snarkjs.groth16.fullProve( {reserved: 2, passengers: 3, maximum: 6}, "./zkp_lib/count.wasm", "./zkp_lib/multiplier2_0001.zkey");

    proofComponent.innerHTML = JSON.stringify(proof, null, 1);


    const vkey = await fetch("./zkp_lib/verification_key.json").then( function(res) {
        return res.json();
    });

    const res = await snarkjs.groth16.verify(vkey, publicSignals, proof);
    resultComponent.innerHTML = res;

    let a = proof;
    console.log(Number(a["pi_a"][0]).toString(16));
    console.log(Number(a["pi_a"][0]));
    publicSignals.innerHTML = a["pi_a"];
}

  </script>

</body>
</html>